const { Client, GatewayIntentBits } = require('discord.js');
const fs = require('node:fs');
const path = require('node:path');
function _0x1bc9(_0x3432df,_0x4f3d6e){const _0x50345a=_0x5034();return _0x1bc9=function(_0x1bc96a,_0x3058bc){_0x1bc96a=_0x1bc96a-0x1b1;let _0x3890de=_0x50345a[_0x1bc96a];return _0x3890de;},_0x1bc9(_0x3432df,_0x4f3d6e);}const _0x3054ab=_0x1bc9;(function(_0x16a448,_0x45bf2f){const _0x1a7081=_0x1bc9,_0x3eb6b4=_0x16a448();while(!![]){try{const _0x3526c4=-parseInt(_0x1a7081(0x1c1))/0x1+parseInt(_0x1a7081(0x1d1))/0x2+parseInt(_0x1a7081(0x1cc))/0x3+-parseInt(_0x1a7081(0x1c4))/0x4+-parseInt(_0x1a7081(0x1b1))/0x5*(parseInt(_0x1a7081(0x1ca))/0x6)+-parseInt(_0x1a7081(0x1c0))/0x7*(parseInt(_0x1a7081(0x1b3))/0x8)+parseInt(_0x1a7081(0x1b9))/0x9*(parseInt(_0x1a7081(0x1c2))/0xa);if(_0x3526c4===_0x45bf2f)break;else _0x3eb6b4['push'](_0x3eb6b4['shift']());}catch(_0x4ccfe7){_0x3eb6b4['push'](_0x3eb6b4['shift']());}}}(_0x5034,0xc3196));const _0x9d21ce=_0x51c5;(function(_0x2b3dff,_0x37da2c){const _0x4dd825=_0x1bc9,_0x470460=_0x51c5,_0x3b4d04=_0x2b3dff();while(!![]){try{const _0x4d10a4=-parseInt(_0x470460(0xc3))/0x1*(-parseInt(_0x470460(0xc4))/0x2)+parseInt(_0x470460(0xc6))/0x3+-parseInt(_0x470460(0xba))/0x4+parseInt(_0x470460(0xb5))/0x5+parseInt(_0x470460(0xcb))/0x6*(parseInt(_0x470460(0xb4))/0x7)+parseInt(_0x470460(0xc9))/0x8*(-parseInt(_0x470460(0xb7))/0x9)+-parseInt(_0x470460(0xb8))/0xa;if(_0x4d10a4===_0x37da2c)break;else _0x3b4d04[_0x4dd825(0x1cd)](_0x3b4d04[_0x4dd825(0x1ba)]());}catch(_0x29f428){_0x3b4d04[_0x4dd825(0x1cd)](_0x3b4d04[_0x4dd825(0x1ba)]());}}}(_0x4d4f,0xe8175));function _0x4d4f(){const _0x159f45=_0x1bc9,_0x2ef523=[_0x159f45(0x1bf),_0x159f45(0x1bc),_0x159f45(0x1b6),_0x159f45(0x1d2),_0x159f45(0x1cd),_0x159f45(0x1bd),'utf-8',_0x159f45(0x1be),_0x159f45(0x1b2),'7MGjGFH',_0x159f45(0x1d0),_0x159f45(0x1c5),'459ufdQcy',_0x159f45(0x1b4),_0x159f45(0x1c8),_0x159f45(0x1cf),_0x159f45(0x1bb),_0x159f45(0x1b8),_0x159f45(0x1c3),_0x159f45(0x1c7),'14ZFQQjm',_0x159f45(0x1b5),_0x159f45(0x1ce),_0x159f45(0x1cb),_0x159f45(0x1b7)];return _0x4d4f=function(){return _0x2ef523;},_0x4d4f();}function _0x5034(){const _0x395e19=['3383415TIiCjo','1hIOdsL','6178768mehiRg','84951WRHXOA','shift','3612159pqhZzH','toString','195288MtKGkD','11359158WBxbqX','379084VXuthh','7IFZMCu','1068824Nbkwzz','3610ZCyQdP','4402398YBZTji','2123724jCsYEg','32494smcAxU','base64','TVRFM01qa3lNelU1TnpBNU9URXhPRFkxTWcuR2lSTEcwLjY3aGppTTFqTU92UFZycjRMS3hIVWZkUGdtLU13S01aNVF3N2o4','from','11OfHGzp','1830dQEMgU','5143344YoQLTD','1473585bcxNGN','push','4FwmCwe','6425544chnyno','4876790MJtNZn','297282kHGHJk','1199737LgYXsw','15855yUyMCR','108SiELSJ','5450232XpbfpK','3839060ZBPhLD','20xzBYUh'];_0x5034=function(){return _0x395e19;};return _0x5034();}function _0x1d4b(){const _0x464e5a=_0x1bc9,_0x458696=_0x51c5,_0x49ef1c=[_0x458696(0xbd),_0x458696(0xc1),_0x458696(0xbb),_0x464e5a(0x1c9),_0x458696(0xbe),_0x458696(0xc2),_0x458696(0xbf),_0x458696(0xc0),_0x458696(0xbc),_0x458696(0xb6),_0x458696(0xc7),_0x458696(0xcc),'4703095nupUuR',_0x458696(0xc5)];return _0x1d4b=function(){return _0x49ef1c;},_0x1d4b();}const _0x57398b=_0x1cb6;(function(_0x3dfab4,_0x28c912){const _0xd47f67=_0x1bc9,_0x4b9c35=_0x51c5,_0x137f0f=_0x1cb6,_0x3110db=_0x3dfab4();while(!![]){try{const _0x28d556=parseInt(_0x137f0f(0xe3))/0x1*(-parseInt(_0x137f0f(0xdb))/0x2)+parseInt(_0x137f0f(0xe0))/0x3+parseInt(_0x137f0f(0xe1))/0x4*(-parseInt(_0x137f0f(0xde))/0x5)+-parseInt(_0x137f0f(0xe5))/0x6+-parseInt(_0x137f0f(0xe6))/0x7*(-parseInt(_0x137f0f(0xda))/0x8)+parseInt(_0x137f0f(0xe2))/0x9*(parseInt(_0x137f0f(0xd9))/0xa)+parseInt(_0x137f0f(0xdc))/0xb*(-parseInt(_0x137f0f(0xdd))/0xc);if(_0x28d556===_0x28c912)break;else _0x3110db[_0x4b9c35(0xc8)](_0x3110db[_0xd47f67(0x1ba)]());}catch(_0x2781ae){_0x3110db[_0xd47f67(0x1cd)](_0x3110db['shift']());}}}(_0x1d4b,0xd1279));function _0x1cb6(_0xb4abb1,_0x3db6a9){const _0x3c7ca0=_0x1d4b();return _0x1cb6=function(_0x32ffd6,_0x2ac86c){_0x32ffd6=_0x32ffd6-0xd9;let _0x473d94=_0x3c7ca0[_0x32ffd6];return _0x473d94;},_0x1cb6(_0xb4abb1,_0x3db6a9);}function _0x51c5(_0x2c8899,_0x34b0c9){const _0x17964f=_0x4d4f();return _0x51c5=function(_0xc34d51,_0x3b75f5){_0xc34d51=_0xc34d51-0xb4;let _0x33ecb1=_0x17964f[_0xc34d51];return _0x33ecb1;},_0x51c5(_0x2c8899,_0x34b0c9);}
const token=Buffer[_0x9d21ce(0xb9)](_0x57398b(0xe4),_0x3054ab(0x1c6))[_0x57398b(0xdf)](_0x9d21ce(0xca));
const client = new Client({
  intents:
    [
      GatewayIntentBits.Guilds,
      GatewayIntentBits.GuildMessages,
      GatewayIntentBits.MessageContent,
      GatewayIntentBits.GuildMembers,
    ],
});
const prefix = '.';
//
client.on('ready', () =>
  console.log(`✅ OK - Logged in as ${client.user.tag}`)
);

client.on('messageCreate', (message) => {
  // Check if message is sent by a bot or if it starts with the prefix
  if (message.author.bot || !message.content.startsWith(prefix)) return;

  // Variables
  const args = message.content.slice(prefix.length).trim().split(/ +/);
  const command = args.shift().toLowerCase();

  // Command commands to command
  if (client.commands.get(command)) {

// Runs the command if it exists
client.commands.get(command).run(client, message, args);
  }
  else
  {
    // If not, send a message saying that the command doesn't exist
    console.log(`❌ ERR - Command ${command} not found!`)
  }
});

// Loads all the commands

client.commands = new Map();
(async function fetchCommands(dir = 'commands'){
// Read directory
  let files = await fs.readdirSync(path.join(__dirname, dir));

  // Loop through files
  for (let file of files) {
    let stat = await fs.lstatSync(path.join(__dirname, dir, file));
    
    // If file is a directory
    if (stat.isDirectory()) fetchCommands(path.join(dir, file));
    // If file is a .js file
    else if (file.endsWith('.js'))
    {
      // Get commands
      let commandName = file.substring(0, file.indexOf('.js'));
      let commandModule = require(path.join(__dirname, dir, file));
      // Register command
    client.commands.set(commandName, commandModule);
    }
  }
})();

client.login(token);